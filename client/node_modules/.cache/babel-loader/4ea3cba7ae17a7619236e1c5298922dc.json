{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\akhan\\\\Documents\\\\social-media-app\\\\client\\\\src\\\\components\\\\loginScreen.js\";\nimport React from \"react\";\nimport \"../componentStyles/loginScreen.css\";\nimport { Link, useParams } from \"react-router-dom\";\nimport Redirect from \"react-router\";\nimport Axios from \"axios\";\nexport default class loginScreen extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      username: \"\",\n      password: \"\",\n      data: null,\n      loggedIn: false\n    };\n    this.failedToLogin.bind(this);\n  }\n\n  assign(e) {\n    if (e.target.name === \"username\") {\n      this.setState({\n        username: e.target.value\n      });\n    }\n\n    if (e.target.name === \"password\") {\n      this.setState({\n        password: e.target.value\n      });\n    }\n  }\n\n  onChange(e) {\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  async onSubmit(e) {\n    const thisUsername = this.state.username;\n    Axios.get(\"/user/\", {\n      params: {\n        username: thisUsername\n      }\n    }).then(response => {\n      console.log(response.status);\n      this.setState({\n        data: response.data[0]\n      });\n\n      if (this.state.data != null) {\n        // user name found\n        const bcrypt = require(\"bcryptjs\");\n\n        console.log(this.state.password, \" + \", this.state.data.password);\n        return new Promise((resolve, reject) => {\n          bcrypt.compare(this.state.password, this.state.data.password, function (err, result) {\n            if (err) reject(err);\n            resolve(result);\n          });\n        }).then(result => {\n          if (result) {\n            //logged in \n            this.setState({\n              loggedIn: true\n            });\n            const loginCircle = document.getElementById(\"login\");\n            loginCircle.setAttribute(\"style\", \"border: solid green\");\n            setTimeout(() => {\n              this.props.history.push({\n                pathname: '/homepage',\n                state: {\n                  thisUsername: this.state.username,\n                  thisUser: this.state.data\n                }\n              });\n            }, 400);\n          } else {\n            this.failedToLogin();\n          }\n        });\n      } else {\n        console.log(\"No matching user found\");\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  isLoggedIn() {\n    return this.state.loggedIn;\n  }\n\n  failedToLogin() {\n    const loginCircle = document.getElementById(\"login\");\n    loginCircle.setAttribute(\"style\", \"border: solid red\");\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"login-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"username\",\n      id: \"username\",\n      placeholder: \"Username\",\n      className: \"credentials\",\n      onChange: this.assign.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      name: \"password\",\n      id: \"password\",\n      placeholder: \"Password\",\n      className: \"credentials\",\n      onChange: this.assign.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"buttons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"login-button\",\n      onClick: this.onSubmit.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }, \"Log in\"), /*#__PURE__*/React.createElement(Link, {\n      to: \"/user/register\",\n      id: \"register-button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }\n    }, \"Register\"))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/akhan/Documents/social-media-app/client/src/components/loginScreen.js"],"names":["React","Link","useParams","Redirect","Axios","loginScreen","Component","constructor","state","username","password","data","loggedIn","failedToLogin","bind","assign","e","target","name","setState","value","onChange","onSubmit","thisUsername","get","params","then","response","console","log","status","bcrypt","require","Promise","resolve","reject","compare","err","result","loginCircle","document","getElementById","setAttribute","setTimeout","props","history","push","pathname","thisUser","catch","isLoggedIn","render"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"../componentStyles/loginScreen.css\";\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport Redirect from \"react-router\";\r\nimport Axios from \"axios\";\r\n\r\nexport default class loginScreen extends React.Component {\r\n  constructor() {\r\n    super();\r\n\r\n    this.state = {\r\n      username: \"\",\r\n      password: \"\",\r\n      data: null,\r\n      loggedIn: false\r\n    };\r\n    this.failedToLogin.bind(this);\r\n  }\r\n\r\n  assign(e) {\r\n    if (e.target.name === \"username\") {\r\n      this.setState({ username: e.target.value });\r\n    }\r\n    if (e.target.name === \"password\") {\r\n      this.setState({ password: e.target.value });\r\n    }\r\n  }\r\n\r\n  onChange(e) {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  }\r\n\r\n  async onSubmit(e) {\r\n    const thisUsername = this.state.username;\r\n    Axios.get(\"/user/\", {\r\n      params: {\r\n        username: thisUsername\r\n      },\r\n    }).then((response) => {\r\n      console.log(response.status);\r\n      this.setState({data: response.data[0]});\r\n      if (this.state.data != null) { // user name found\r\n        const bcrypt = require(\"bcryptjs\");\r\n        console.log(this.state.password, \" + \", this.state.data.password);\r\n        return new Promise((resolve, reject) => {\r\n          bcrypt.compare(\r\n            this.state.password,\r\n            this.state.data.password,\r\n            function (err, result) {\r\n              if (err) reject(err);\r\n              resolve(result);\r\n            }\r\n          );\r\n        }).then((result) => {\r\n          if (result) { //logged in \r\n            this.setState({loggedIn: true})\r\n            const loginCircle = document.getElementById(\"login\");\r\n            loginCircle.setAttribute(\"style\", \"border: solid green\");\r\n            setTimeout(() => {\r\n              this.props.history.push({\r\n              pathname: '/homepage',\r\n              state: { thisUsername: this.state.username, thisUser: this.state.data }\r\n              }); \r\n            }, 400);\r\n          } else {\r\n            this.failedToLogin(); \r\n          }\r\n        });\r\n      } else {\r\n        console.log(\"No matching user found\");\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      console.log(err)\r\n    })\r\n  }\r\n\r\n  isLoggedIn(){\r\n    return this.state.loggedIn\r\n  }\r\n\r\n  failedToLogin() {\r\n    const loginCircle = document.getElementById(\"login\");\r\n    loginCircle.setAttribute(\"style\", \"border: solid red\");\r\n  }\r\n\r\n  render() {\r\n    return (\r\n     <div id = \"login-wrap\">\r\n      <div id=\"login\">\r\n        <input\r\n          type=\"text\"\r\n          name=\"username\"\r\n          id=\"username\"\r\n          placeholder=\"Username\"\r\n          className=\"credentials\"\r\n          onChange={this.assign.bind(this)}\r\n        ></input>\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          id=\"password\"\r\n          placeholder=\"Password\"\r\n          className=\"credentials\"\r\n          onChange={this.assign.bind(this)}\r\n        ></input>\r\n        <div id=\"buttons\">\r\n          <div id=\"login-button\" onClick={this.onSubmit.bind(this)}>\r\n            Log in\r\n          </div>\r\n          <Link to=\"/user/register\" id=\"register-button\">\r\n            Register\r\n          </Link>\r\n        </div>\r\n      </div>\r\n      </div> \r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}